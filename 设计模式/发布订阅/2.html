<script>
    class EventEmitter {
    //构造函数，初始化事件列表  eventName: [cb1,cb2,cb3]
    constructor() {
        this.eventList = {

        }
    }
    //订阅(事件，人),向对应eventName的数组中添加cb  
    on(eventName, cb) {
        if (!this.eventList[eventName]) {
            this.eventList[eventName] = []
        }
        this.eventList[eventName].push(cb)
    }
    //发布事件，触发对应eventName中的所有cb
    emit(eventName) {
        if (this.eventList[eventName]) {
            const handlers = this.eventList[eventName].slice()//拷贝对应eventName数组
            handlers.forEach(handler => {
                handler()
            })//触发所有cb
        }
    }
    //取消订阅，移除对应eventName中的cb
    off(eventName, cb) {
        const callbacks = this.eventList[eventName]
        const index = callbacks.indexOf(cb)
        if (index !== -1) {
            callbacks.splice(index, 1)
        }
    }
    //只订阅一次，触发一次后，自动移除
    once(eventName, cb) {
        const wrap = () => {
            cb()
            this.off(eventName, wrap)
        }
        this.on(eventName, wrap)
    }
}
const eventEmitter=new EventEmitter()
function fnA(){
    setTimeout(()=>{
        console.log('fnA执行了')
        eventEmitter.emit('next')
    },1000)
}
function fnB(){
    setTimeout(()=>{
        console.log('fnB执行了');
        
    },500)
}
eventEmitter.on('next',fnB)
fnA()
</script>